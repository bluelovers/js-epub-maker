"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const handlebars_1 = require("handlebars");
exports.Handlebars = handlebars_1.default;
// @ts-ignore
const path = require("path");
// @ts-ignore
const fs = require("fs");
const _1 = require(".");
exports.mimetypes = {
    'jpeg': 'image/jpeg',
    'jpg': 'image/jpeg',
    'bmp': 'image/bmp',
    'png': 'image/png',
    'svg': 'image/svg+xml',
    'gif': 'image/gif',
    'ttf': 'application/x-font-truetype',
    'css': 'text/css',
};
handlebars_1.default.registerHelper('extension', function (str) {
    return ext(str);
});
handlebars_1.default.registerHelper('mimetype', function (str) {
    return exports.mimetypes[ext(str)];
});
handlebars_1.default.registerHelper('import', function (filePath, options) {
    filePath = path.normalize(filePath);
    let source = fs.readFileSync(filePath).toString();
    return new handlebars_1.default.SafeString(handlebars_1.default.compile(source)(Object.create(this)));
});
function ext(str) {
    if (str === undefined) {
        return str;
    }
    return str.substr(str.lastIndexOf('.') + 1);
}
function compileTpl(template, content, skipFormatting) {
    return _1.default.formatHTML(handlebars_1.default.compile(template)(content), skipFormatting);
}
exports.compileTpl = compileTpl;
exports.default = handlebars_1.default;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFuZGxlYmFyLWhlbHBlcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJoYW5kbGViYXItaGVscGVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDJDQUFvQztBQXFEM0IscUJBckRGLG9CQUFVLENBcURFO0FBcERuQixhQUFhO0FBQ2IsNkJBQTZCO0FBQzdCLGFBQWE7QUFDYix5QkFBeUI7QUFFekIsd0JBQWlDO0FBRXBCLFFBQUEsU0FBUyxHQUFHO0lBQ3hCLE1BQU0sRUFBRSxZQUFZO0lBQ3BCLEtBQUssRUFBRSxZQUFZO0lBQ25CLEtBQUssRUFBRSxXQUFXO0lBQ2xCLEtBQUssRUFBRSxXQUFXO0lBQ2xCLEtBQUssRUFBRSxlQUFlO0lBQ3RCLEtBQUssRUFBRSxXQUFXO0lBQ2xCLEtBQUssRUFBRSw2QkFBNkI7SUFDcEMsS0FBSyxFQUFFLFVBQVU7Q0FDakIsQ0FBQztBQUVGLG9CQUFVLENBQUMsY0FBYyxDQUFDLFdBQVcsRUFBRSxVQUFVLEdBQUc7SUFFbkQsT0FBTyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDakIsQ0FBQyxDQUFDLENBQUM7QUFFSCxvQkFBVSxDQUFDLGNBQWMsQ0FBQyxVQUFVLEVBQUUsVUFBVSxHQUFHO0lBRWxELE9BQU8saUJBQVMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUM1QixDQUFDLENBQUMsQ0FBQztBQUVILG9CQUFVLENBQUMsY0FBYyxDQUFDLFFBQVEsRUFBRSxVQUFVLFFBQVEsRUFBRSxPQUFPO0lBRTlELFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBRXBDLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7SUFFbEQsT0FBTyxJQUFJLG9CQUFVLENBQUMsVUFBVSxDQUFDLG9CQUFVLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ25GLENBQUMsQ0FBQyxDQUFDO0FBRUgsU0FBUyxHQUFHLENBQUMsR0FBRztJQUVmLElBQUksR0FBRyxLQUFLLFNBQVMsRUFDckI7UUFDQyxPQUFPLEdBQUcsQ0FBQztLQUNYO0lBRUQsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDN0MsQ0FBQztBQUVELFNBQWdCLFVBQVUsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLGNBQXdCO0lBRXJFLE9BQU8sVUFBVSxDQUFDLFVBQVUsQ0FBQyxvQkFBVSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxjQUFjLENBQUMsQ0FBQztBQUNyRixDQUFDO0FBSEQsZ0NBR0M7QUFJRCxrQkFBZSxvQkFBVSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEhhbmRsZWJhcnMgZnJvbSAnaGFuZGxlYmFycyc7XG4vLyBAdHMtaWdub3JlXG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuLy8gQHRzLWlnbm9yZVxuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuXG5pbXBvcnQgZXB1YlRwbExpYiwgeyAgfSBmcm9tICcuJztcblxuZXhwb3J0IGNvbnN0IG1pbWV0eXBlcyA9IHtcblx0J2pwZWcnOiAnaW1hZ2UvanBlZycsXG5cdCdqcGcnOiAnaW1hZ2UvanBlZycsXG5cdCdibXAnOiAnaW1hZ2UvYm1wJyxcblx0J3BuZyc6ICdpbWFnZS9wbmcnLFxuXHQnc3ZnJzogJ2ltYWdlL3N2Zyt4bWwnLFxuXHQnZ2lmJzogJ2ltYWdlL2dpZicsXG5cdCd0dGYnOiAnYXBwbGljYXRpb24veC1mb250LXRydWV0eXBlJyxcblx0J2Nzcyc6ICd0ZXh0L2NzcycsXG59O1xuXG5IYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCdleHRlbnNpb24nLCBmdW5jdGlvbiAoc3RyKVxue1xuXHRyZXR1cm4gZXh0KHN0cik7XG59KTtcblxuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignbWltZXR5cGUnLCBmdW5jdGlvbiAoc3RyKVxue1xuXHRyZXR1cm4gbWltZXR5cGVzW2V4dChzdHIpXTtcbn0pO1xuXG5IYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCdpbXBvcnQnLCBmdW5jdGlvbiAoZmlsZVBhdGgsIG9wdGlvbnMpXG57XG5cdGZpbGVQYXRoID0gcGF0aC5ub3JtYWxpemUoZmlsZVBhdGgpO1xuXG5cdGxldCBzb3VyY2UgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZVBhdGgpLnRvU3RyaW5nKCk7XG5cblx0cmV0dXJuIG5ldyBIYW5kbGViYXJzLlNhZmVTdHJpbmcoSGFuZGxlYmFycy5jb21waWxlKHNvdXJjZSkoT2JqZWN0LmNyZWF0ZSh0aGlzKSkpO1xufSk7XG5cbmZ1bmN0aW9uIGV4dChzdHIpXG57XG5cdGlmIChzdHIgPT09IHVuZGVmaW5lZClcblx0e1xuXHRcdHJldHVybiBzdHI7XG5cdH1cblxuXHRyZXR1cm4gc3RyLnN1YnN0cihzdHIubGFzdEluZGV4T2YoJy4nKSArIDEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZVRwbCh0ZW1wbGF0ZSwgY29udGVudCwgc2tpcEZvcm1hdHRpbmc/OiBib29sZWFuKTogc3RyaW5nXG57XG5cdHJldHVybiBlcHViVHBsTGliLmZvcm1hdEhUTUwoSGFuZGxlYmFycy5jb21waWxlKHRlbXBsYXRlKShjb250ZW50KSwgc2tpcEZvcm1hdHRpbmcpO1xufVxuXG5leHBvcnQgeyBIYW5kbGViYXJzIH07XG5cbmV4cG9ydCBkZWZhdWx0IEhhbmRsZWJhcnM7XG4iXX0=